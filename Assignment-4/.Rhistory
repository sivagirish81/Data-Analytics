quality
Lwine$category[Lwine$trans.quality <= 5] <- 0
Lwine$category[Lwine$trans.quality > 5] <- 1
summary(Lwine$category)
str(Lwine)
Lwine$Category[Lwine$trans.quality <= 5] <- 0
Lwine$Category[Lwine$trans.quality > 5] <- 1
summary(Lwine$category)
summary(Lwine$Category)
str(Lwine)
library("rmdformats")
library("corrgram")
library("MASS")
library("ggplot2")
library("naniar")
library("e1071")
library("lattice")
library("caret")
wine<-read.csv("winedata/winequality_white.csv")
head(wine)
library(corrplot)
corrplot(cor(wine),method="number")
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$citric.acid+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
#Removing Multi Collinear variables and values with low p score
#We are able to effectively predict the quality of white wines
#The Ad
LinMod<-lm(wine$quality~wine$volatile.acidity+wine$density+wine$alcohol+wine$residual.sugar+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod1<-lm(wine$quality~wine$alcohol+wine$density+wine$chlorides)
summary(LinMod1)
str(wine)
dim(wine)
wine <- wine[!duplicated(wine), ]
dim(wine)
vis_miss(wine)
sum(is.na(wine))
attach(wine)
skewness(wine$quality)
detach(wine)
preprocess_wine <- preProcess(wine[,1:11], c("BoxCox", "center", "scale"))
new_wine <- data.frame(trans = predict(preprocess_wine, wine))
summary(new_wine)
new_wine <- new_wine[!abs(new_wine$trans.fixed.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.volatile.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.citric.acid) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.residual.sugar) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.chlorides) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.density) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.pH) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.sulphates) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.alcohol) > 3,]
summary(new_wine)
wine<-new_wine
summary(wine)
skewness(wine$trans.residual.sugar)
corrplot(cor(wine),method="number")
LinearModel<-lm(wine$trans.quality~.,data=wine)
summary(LinearModel)
#Variance inflation factor
vif(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density,data=wine)
summary(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density- trans.fixed.acidity - trans.citric.acid,data=wine)
summary(LinearModel)
#Logistic Regression
nwine<-wine
summary(nwine)
nwine$category[nwine$quality <= 5] <- 0
nwine$category[nwine$quality > 5] <- 1
nwine$category <- as.factor(nwine$category)
Lwine<-new_wine
Lwine$Category<-NA
Lwine$Category[Lwine$trans.quality <= 5] <- 0
Lwine$Category[Lwine$trans.quality > 5] <- 1
summary(Lwine$Category)
str(Lwine)
model_glm <- glm(category ~ . - quality - quality2, data = whitetrain, family=binomial(link = "logit"))
model_glm <- glm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
summary(LogisticModel)
LogisticModelStepwise <- step(LogisticModel)
rsq(LogisticModelStepwise,adj=TRUE,type=(v','kl','sse','lr','n'),data=Lwine)
rsq(LogisticModelStepwise,adj=TRUE,type=c(v','kl','sse','lr','n'),data=Lwine)
rsq(LogisticModelStepwise,adj=TRUE,type=c('v','kl','sse','lr','n'),data=Lwine)
rsq <- function (x, y) cor(x, y) ^ 2
rsq(LogisticModelStepwise,adj=TRUE,type=c('v','kl','sse','lr','n'),data=Lwine)
rsq(LogisticModelStepwise,adj=TRUE,data=Lwine)
View(rsq)
library("rmdformats")
library("corrgram")
library("MASS")
library("ggplot2")
library("naniar")
library("e1071")
library("lattice")
library("caret")
wine<-read.csv("winedata/winequality_white.csv")
head(wine)
library(corrplot)
corrplot(cor(wine),method="number")
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$citric.acid+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
#Removing Multi Collinear variables and values with low p score
#We are able to effectively predict the quality of white wines
#The Ad
LinMod<-lm(wine$quality~wine$volatile.acidity+wine$density+wine$alcohol+wine$residual.sugar+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod1<-lm(wine$quality~wine$alcohol+wine$density+wine$chlorides)
summary(LinMod1)
str(wine)
dim(wine)
wine <- wine[!duplicated(wine), ]
dim(wine)
vis_miss(wine)
sum(is.na(wine))
attach(wine)
skewness(wine$quality)
detach(wine)
preprocess_wine <- preProcess(wine[,1:11], c("BoxCox", "center", "scale"))
new_wine <- data.frame(trans = predict(preprocess_wine, wine))
summary(new_wine)
new_wine <- new_wine[!abs(new_wine$trans.fixed.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.volatile.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.citric.acid) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.residual.sugar) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.chlorides) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.density) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.pH) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.sulphates) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.alcohol) > 3,]
summary(new_wine)
wine<-new_wine
summary(wine)
skewness(wine$trans.residual.sugar)
corrplot(cor(wine),method="number")
LinearModel<-lm(wine$trans.quality~.,data=wine)
summary(LinearModel)
#Variance inflation factor
vif(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density,data=wine)
summary(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density- trans.fixed.acidity - trans.citric.acid,data=wine)
summary(LinearModel)
#Logistic Regression
nwine<-wine
summary(nwine)
nwine$category[nwine$quality <= 5] <- 0
nwine$category[nwine$quality > 5] <- 1
nwine$category <- as.factor(nwine$category)
Lwine<-new_wine
Lwine$Category<-NA
Lwine$Category[Lwine$trans.quality <= 5] <- 0
Lwine$Category[Lwine$trans.quality > 5] <- 1
summary(Lwine$Category)
str(Lwine)
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
summary(LogisticModel)
#rsq <- function (x, y) cor(x, y) ^ 2
LogisticModelStepwise <- step(LogisticModel)
rsq(LogisticModelStepwise,adj=TRUE,data=Lwine)
r.squared(LogisticModelStepwise)
Rsq(LogisticModelStepwise,adj=TRUE,data=Lwine)
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
summary(LogisticModel)
Nul<-LogisticModel$null.deviance/-2
Prop<-LogisticModel$deviance/-2
R2<-(Nul-Prop)/Nul
R2
p_val<-1-pchisq(2*(Prop-Nul),df=length(LogisticModel$coefficients-1))
p_val
library("rmdformats")
library("corrgram")
library("MASS")
library("ggplot2")
library("naniar")
library("e1071")
library("lattice")
library("caret")
wine<-read.csv("winedata/winequality_white.csv")
head(wine)
library(corrplot)
corrplot(cor(wine),method="number")
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$citric.acid+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
#Removing Multi Collinear variables and values with low p score
#We are able to effectively predict the quality of white wines
#The Ad
LinMod<-lm(wine$quality~wine$volatile.acidity+wine$density+wine$alcohol+wine$residual.sugar+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod1<-lm(wine$quality~wine$alcohol+wine$density+wine$chlorides)
summary(LinMod1)
str(wine)
dim(wine)
wine <- wine[!duplicated(wine), ]
dim(wine)
vis_miss(wine)
sum(is.na(wine))
attach(wine)
skewness(wine$quality)
detach(wine)
preprocess_wine <- preProcess(wine[,1:11], c("BoxCox", "center", "scale"))
new_wine <- data.frame(trans = predict(preprocess_wine, wine))
summary(new_wine)
new_wine <- new_wine[!abs(new_wine$trans.fixed.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.volatile.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.citric.acid) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.residual.sugar) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.chlorides) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.density) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.pH) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.sulphates) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.alcohol) > 3,]
summary(new_wine)
wine<-new_wine
summary(wine)
skewness(wine$trans.residual.sugar)
corrplot(cor(wine),method="number")
LinearModel<-lm(wine$trans.quality~.,data=wine)
summary(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density- trans.fixed.acidity - trans.citric.acid,data=wine)
summary(LinearModel)
PolyMod<-lm(wine$quality~wine$volatile.acidity+wine$citric.acid+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$pH+wine$sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~wine$trans.volatile.acidity+wine$trans.citric.acid+wine$trans.residual.sugar+wine$trans.chlorides+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod1<-lm(wine$trans.quality~wine$trans.volatile.acidity+wine$trans.citric.acid+wine$trans.chlorides+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod1)
PolyMod1<-lm(wine$trans.quality~wine$trans.volatile.acidity+wine$trans.citric.acid+wine$trans.chlorides+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod1)
+wine$trans.residual.sugar
PolyMod1<-lm(wine$trans.quality~wine$trans.volatile.acidity+wine$trans.citric.acid+wine$trans.residual.sugar+wine$trans.chlorides+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod1)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,2)+wine$trans.citric.acid+wine$trans.residual.sugar+wine$trans.chlorides+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+wine$trans.citric.acid+wine$trans.residual.sugar+wine$trans.chlorides+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+wine$trans.residual.sugar+wine$trans.chlorides+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+wine$trans.chlorides+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+wine$trans.free.sulfur.dioxide+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.free.sulfur.dioxide,4)+wine$trans.total.sulfur.dioxide+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.free.sulfur.dioxide,4)+poly(wine$trans.total.sulfur.dioxide,4)+wine$trans.pH+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.free.sulfur.dioxide,4)+poly(wine$trans.total.sulfur.dioxide,4)+poly(wine$trans.pH,4)+wine$trans.sulphates,data=wine)
summary(PolyMod)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.free.sulfur.dioxide,4)+poly(wine$trans.total.sulfur.dioxide,4)+poly(wine$trans.pH,4)+poly(wine$trans.sulphates,4),data=wine)
summary(PolyMod)
PolyMod2<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.free.sulfur.dioxide,4)+poly(wine$trans.total.sulfur.dioxide,4)+poly(wine$trans.sulphates,4),data=wine)
summary(PolyMod2)
PolyMod2<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.total.sulfur.dioxide,4)+poly(wine$trans.sulphates,4),data=wine)
summary(PolyMod2)
library("rmdformats")
library("corrgram")
library("MASS")
library("ggplot2")
library("naniar")
library("e1071")
library("lattice")
library("caret")
wine<-read.csv("winedata/winequality_white.csv")
head(wine)
library(corrplot)
corrplot(cor(wine),method="number")
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$citric.acid+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
#Removing Multi Collinear variables and values with low p score
#We are able to effectively predict the quality of white wines
#The Ad
LinMod<-lm(wine$quality~wine$volatile.acidity+wine$density+wine$alcohol+wine$residual.sugar+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod1<-lm(wine$quality~wine$alcohol+wine$density+wine$chlorides)
summary(LinMod1)
str(wine)
dim(wine)
wine <- wine[!duplicated(wine), ]
dim(wine)
vis_miss(wine)
sum(is.na(wine))
attach(wine)
skewness(wine$quality)
detach(wine)
preprocess_wine <- preProcess(wine[,1:11], c("BoxCox", "center", "scale"))
new_wine <- data.frame(trans = predict(preprocess_wine, wine))
summary(new_wine)
new_wine <- new_wine[!abs(new_wine$trans.fixed.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.volatile.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.citric.acid) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.residual.sugar) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.chlorides) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.density) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.pH) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.sulphates) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.alcohol) > 3,]
summary(new_wine)
wine<-new_wine
summary(wine)
skewness(wine$trans.residual.sugar)
corrplot(cor(wine),method="number")
LinearModel<-lm(wine$trans.quality~.,data=wine)
summary(LinearModel)
#Variance inflation factor
vif(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density,data=wine)
summary(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density- trans.fixed.acidity - trans.citric.acid,data=wine)
summary(LinearModel)
#Logistic Regression
nwine<-wine
summary(nwine)
nwine$category[nwine$quality <= 5] <- 0
nwine$category[nwine$quality > 5] <- 1
nwine$category <- as.factor(nwine$category)
Lwine<-new_wine
Lwine$Category<-NA
Lwine$Category[Lwine$trans.quality <= 5] <- 0
Lwine$Category[Lwine$trans.quality > 5] <- 1
summary(Lwine$Category)
str(Lwine)
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
summary(LogisticModel)
LogisticModel <- lm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
summary(LogisticModel)
install.packages("ResourceSelection")
library("ResourceSelection")
hoslem.test(LogisticModel$Category, LogisticModel$fitted)
hoslem.test(LogisticModel$Category, fitted(LogisticModel))
hoslem.test(LogisticModel$Category,fitted(LogisticModel),g=10)
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
summary(LogisticModel)
hoslem.test(LogisticModel$Category,fitted(LogisticModel),g=10)
LogisticModel <- lm(Lwine$Category ~ ., data = Lwine, family=binomial)
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial)
summary(LogisticModel)
hoslem.test(LogisticModel$Category,fitted(LogisticModel),g=10)
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.free.sulfur.dioxide,4)+poly(wine$trans.total.sulfur.dioxide,4)+poly(wine$trans.pH,4)+poly(wine$trans.sulphates,4),data=wine)
summary(PolyMod)
spl = sample.split(Lwine$category, SplitRatio = 0.7)
spl = Lwine.split(Lwine$category, SplitRatio = 0.7)
spl = split(Lwine$category, SplitRatio = 0.7)
library("catools")
install.packages("caTools")
library("rmdformats")
library("ResourceSelection")
library("corrgram")
library("MASS")
library("ggplot2")
library("naniar")
library("e1071")
library("lattice")
library("caret")
library("caTools")
wine<-read.csv("winedata/winequality_white.csv")
head(wine)
library(corrplot)
corrplot(cor(wine),method="number")
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$citric.acid+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod<-lm(wine$quality~wine$fixed.acidity+wine$volatile.acidity+wine$residual.sugar+wine$chlorides+wine$free.sulfur.dioxide+wine$total.sulfur.dioxide+wine$density+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
#Removing Multi Collinear variables and values with low p score
#We are able to effectively predict the quality of white wines
#The Ad
LinMod<-lm(wine$quality~wine$volatile.acidity+wine$density+wine$alcohol+wine$residual.sugar+wine$pH+wine$sulphates,data=wine)
summary(LinMod)
LinMod1<-lm(wine$quality~wine$alcohol+wine$density+wine$chlorides)
summary(LinMod1)
str(wine)
dim(wine)
wine <- wine[!duplicated(wine), ]
dim(wine)
vis_miss(wine)
sum(is.na(wine))
attach(wine)
skewness(wine$quality)
detach(wine)
preprocess_wine <- preProcess(wine[,1:11], c("BoxCox", "center", "scale"))
new_wine <- data.frame(trans = predict(preprocess_wine, wine))
summary(new_wine)
new_wine <- new_wine[!abs(new_wine$trans.fixed.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.volatile.acidity) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.citric.acid) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.residual.sugar) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.chlorides) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.density) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.pH) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.sulphates) > 3,]
new_wine <- new_wine[!abs(new_wine$trans.alcohol) > 3,]
summary(new_wine)
wine<-new_wine
summary(wine)
skewness(wine$trans.residual.sugar)
corrplot(cor(wine),method="number")
LinearModel<-lm(wine$trans.quality~.,data=wine)
summary(LinearModel)
#Variance inflation factor
vif(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density,data=wine)
summary(LinearModel)
LinearModel<-lm(wine$trans.quality~.-trans.density- trans.fixed.acidity - trans.citric.acid,data=wine)
summary(LinearModel)
#Logistic Regression
nwine<-wine
summary(nwine)
nwine$category[nwine$quality <= 5] <- 0
nwine$category[nwine$quality > 5] <- 1
nwine$category <- as.factor(nwine$category)
Lwine<-new_wine
Lwine$Category<-NA
Lwine$Category[Lwine$trans.quality <= 5] <- 0
Lwine$Category[Lwine$trans.quality > 5] <- 1
summary(Lwine$Category)
str(Lwine)
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial(link = "logit"))
summary(LogisticModel)
hoslem.test(LogisticModel$Category,fitted(LogisticModel),g=10)
#rsq <- function (x, y) cor(x, y) ^ 2
LogisticModelStepwise <- step(LogisticModel)
Rsq(LogisticModelStepwise,adj=TRUE,data=Lwine)
Nul<-LogisticModel$null.deviance/-2
Prop<-LogisticModel$deviance/-2
R2<-(Nul-Prop)/Nul
R2
p_val<-1-pchisq(2*(Prop-Nul),df=length(LogisticModel$coefficients-1))
p_val
PolyMod<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.free.sulfur.dioxide,4)+poly(wine$trans.total.sulfur.dioxide,4)+poly(wine$trans.pH,4)+poly(wine$trans.sulphates,4),data=wine)
summary(PolyMod)
PolyMod2<-lm(wine$trans.quality~poly(wine$trans.volatile.acidity,4)+poly(wine$trans.citric.acid,4)+poly(wine$trans.residual.sugar,4)+poly(wine$trans.chlorides,4)+poly(wine$trans.total.sulfur.dioxide,4)+poly(wine$trans.sulphates,4),data=wine)
summary(PolyMod2)
LogisticModel <- glm(Lwine$Category ~ ., data = Lwine, family=binomial)
summary(LogisticModel)
hoslem.test(LogisticModel$Category,fitted(LogisticModel),g=10)
spl = Lwine.split(Lwine$Category, SplitRatio = 0.7)
trainer = subset(white, spl==TRUE)
tester = subset(white, spl==FALSE)
head(triner)
spl = Lwine.split(Lwine$Category, SplitRatio = 0.7)
spl = split(Lwine$Category, SplitRatio = 0.7)
spl = sample.split(Lwine$Category, SplitRatio = 0.7)
trainer = subset(Lwine, spl==TRUE)
tester = subset(Lwine, spl==FALSE)
head(triner)
head(trainer)
LogisticModel <- glm(category ~ ., data = trainer, family=binomial(link = "logit"))
LogisticModel <- glm(Category ~ ., data = trainer, family=binomial(link = "logit"))
summary(LogisticModel)
head(fitted(LogisticModel))
spl = sample.split(wine$Category, SplitRatio = 0.7)
cwine<-wine
cwine$Category[wine$trans.quality <= 5] <- 0
cwine$Category[wine$trans.quality > 5] <- 1
spl = sample.split(cwine$Category, SplitRatio = 0.7)
trainer = subset(cwine, spl==TRUE)
tester = subset(cwine, spl==FALSE)
head(trainer)
LogisticModel <- glm(Category ~ ., data = trainer, family=binomial(link = "logit"))
summary(LogisticModel)
head(fitted(LogisticModel))
head(train)
head(trainer)
wine<-read.csv("winedata/winequality_white.csv")
wine<-read.csv("winedata/winequality_white.csv")
head(wine)
cwine<-wine
cwine$Category[wine$trans.quality <= 5] <- 0
cwine$Category<-NA
cwine$Category[wine$trans.quality <= 5] <- 0
cwine$Category[wine$trans.quality > 5] <- 1
spl = sample.split(cwine$Category, SplitRatio = 0.7)
trainer = subset(cwine, spl==TRUE)
tester = subset(cwine, spl==FALSE)
head(trainer)
cwine<-wine
cwine <- cwine[!duplicated(wine), ]
cwine$Category<-NA
cwine$Category[wine$quality <= 5] <- 0
cwine$Category[wine$quality > 5] <- 1
cwine$Category<-NA
cwine$Category[wine$quality <= 5] <- 0
cwine <- cwine[!duplicated(wine), ]
cwine$Category<-NA
cwine$Category[cwine$quality <= 5] <- 0
cwine$Category[cwine$quality > 5] <- 1
head(trainer)
wine<-read.csv("winedata/winequality_white.csv")
head(wine)
cwine<-wine
head(cwine)
cwine <- cwine[!duplicated(wine), ]
cwine$Category<-NA
cwine$Category[cwine$quality <= 5] <- 0
cwine$Category[cwine$quality > 5] <- 1
head(cwine)
spl = sample.split(cwine$Category, SplitRatio = 0.7)
trainer = subset(cwine, spl==TRUE)
tester = subset(cwine, spl==FALSE)
head(trainer)
LogisticModel <- glm(Category ~ ., data = trainer, family=binomial(link = "logit"))
summary(LogisticModel)
head(fitted(LogisticModel))
head(trainer)
